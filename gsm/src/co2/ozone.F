      subroutine ozone(l,p,t,r)                                                 
c    l=no. of profile;p=user pressure;r=output o3 mixing ratio                  
c                                                                               
c  to make pgm flow,we assume us std atm=subtropical summer in                  
c  water and ozone                                                              
      dimension o3mac(33,7),pmac(33,7)                                          
      dimension o3mac1(33),o3mac2(33),o3mac3(33),o3mac4(33),o3mac5(33),         
     1 o3mac6(33),o3mac7(33)                                                    
      dimension pmac1(33),pmac2(33),pmac3(33),pmac4(33),pmac5(33),              
     1 pmac6(33),pmac7(33)                                                      
      equivalence (o3mac1(1),o3mac(1,1)),(o3mac2(1),o3mac(1,2))                 
      equivalence (o3mac3(1),o3mac(1,3)),(o3mac4(1),o3mac(1,4))                 
      equivalence (o3mac5(1),o3mac(1,5)),(pmac1(1),pmac(1,1))                   
      equivalence (pmac2(1),pmac(1,2)),(pmac3(1),pmac(1,3))                     
      equivalence (pmac4(1),pmac(1,4)),(pmac5(1),pmac(1,5))                     
      equivalence (o3mac6(1),o3mac(1,6)),(pmac6(1),pmac(1,6))                   
      equivalence (o3mac7(1),o3mac(1,7)),(pmac7(1),pmac(1,7))                   
c    o3mac=mc clatchy ozone mixing ratio;p=mc clartchy pressuresqq              
      data o3mac1/                                                              
     1 5.6e-5,5.6e-5,5.4e-5,5.1e-5,4.7e-5,4.5e-5,4.3e-5,4.1e-5,3.9e-5,          
     2 3.9e-5,3.9e-5,4.1e-5,4.3e-5,4.5e-5,4.5e-5,4.7e-5,4.7e-5,6.9e-5,          
     3 9.0e-5,1.4e-4,1.9e-4,2.4e-4,2.8e-4,3.2e-4,3.4e-4,3.4e-4,2.4e-4,          
     4 9.2e-5,4.1e-5,1.3e-5,4.3e-6,8.6e-8,4.3e-11                               
     5             /                                                            
      data o3mac2/                                                              
     1 6.0e-5,6.0e-5,6.0e-5,6.2e-5,6.4e-5,6.6e-5,6.9e-5,7.5e-5,7.9e-5,          
     2 8.6e-5,9.0e-5,1.1e-4,1.2e-4,1.5e-4,1.8e-4,1.9e-4,2.1e-4,2.4e-4,          
     3 2.8e-4,3.2e-4,3.4e-4,3.6e-4,3.6e-4,3.4e-4,3.2e-4,3.0e-4,2.0e-4,          
     4 9.2e-5,4.1e-5,1.3e-5,4.3e-6,8.6e-8,4.3e-11                               
     5             /                                                            
      data o3mac3/                                                              
     1 6.0e-5,5.4e-5,4.9e-5,4.9e-5,4.9e-5,5.8e-5,6.4e-5,7.7e-5,9.0e-5,          
     2 1.2e-4,1.6e-4,2.1e-4,2.6e-4,3.0e-4,3.2e-4,3.4e-4,3.6e-4,3.9e-4,          
     3 4.1e-4,4.3e-4,4.5e-4,4.3e-4,4.3e-4,3.9e-4,3.6e-4,3.4e-4,1.9e-4,          
     4 9.2e-5,4.1e-5,1.3e-5,4.3e-6,8.6e-8,4.3e-11                               
     5             /                                                            
      data o3mac4/                                                              
     1 4.9e-5,5.4e-5,5.6e-5,5.8e-5,6.0e-5,6.4e-5,7.1e-5,7.5e-5,7.9e-5,          
     2 1.1e-4,1.3e-4,1.8e-4,2.1e-4,2.6e-4,2.8e-4,3.2e-4,3.4e-4,3.9e-4,          
     3 4.1e-4,4.1e-4,3.9e-4,3.6e-4,3.2e-4,3.0e-4,2.8e-4,2.6e-4,1.4e-4,          
     4 9.2e-5,4.1e-5,1.3e-5,4.3e-6,8.6e-8,4.3e-11                               
     5             /                                                            
      data o3mac5/                                                              
     1 4.1e-5,4.1e-5,4.1e-5,4.3e-5,4.5e-5,4.7e-5,4.9e-5,7.1e-5,9.0e-5,          
     2 1.6e-4,2.4e-4,3.2e-4,4.3e-4,4.7e-4,4.9e-4,5.6e-4,6.2e-4,6.2e-4,          
     3 6.2e-4,6.0e-4,5.6e-4,5.1e-4,4.7e-4,4.3e-4,3.6e-4,3.2e-4,1.5e-4,          
     4 9.2e-5,4.1e-5,1.3e-5,4.3e-6,8.6e-8,4.3e-11                               
     5             /                                                            
      data o3mac6/                                                              
     1 6.0e-5,6.0e-5,6.0e-5,6.2e-5,6.4e-5,6.6e-5,6.9e-5,7.5e-5,7.9e-5,          
     2 8.6e-5,9.0e-5,1.1e-4,1.2e-4,1.5e-4,1.8e-4,1.9e-4,2.1e-4,2.4e-4,          
     3 2.8e-4,3.2e-4,3.4e-4,3.6e-4,3.6e-4,3.4e-4,3.2e-4,3.0e-4,2.0e-4,          
     4 9.2e-5,4.1e-5,1.3e-5,4.3e-6,8.6e-8,4.3e-11                               
     5             /                                                            
      data o3mac7/                                                              
     1 6.0e-5,6.0e-5,6.0e-5,6.2e-5,6.4e-5,6.6e-5,6.9e-5,7.5e-5,7.9e-5,          
     2 8.6e-5,9.0e-5,1.1e-4,1.2e-4,1.5e-4,1.8e-4,1.9e-4,2.1e-4,2.4e-4,          
     3 2.8e-4,3.2e-4,3.4e-4,3.6e-4,3.6e-4,3.4e-4,3.2e-4,3.0e-4,2.0e-4,          
     4 9.2e-5,4.1e-5,1.3e-5,4.3e-6,8.6e-8,4.3e-11                               
     5             /                                                            
      data pmac1/                                                               
     1 1.013e+3,9.040e+2,8.050e+2,7.150e+2,6.330e+2,5.590e+2,4.920e+2,          
     2 4.320e+2,3.780e+2,3.290e+2,2.860e+2,2.470e+2,2.130e+2,1.820e+2,          
     3 1.560e+2,1.320e+2,1.110e+2,9.370e+1,7.890e+1,6.660e+1,5.650e+1,          
     4 4.800e+1,4.090e+1,3.500e+1,3.000e+1,2.570e+1,1.220e+1,6.000e+0,          
     5 3.050e+0,1.590e+0,8.540e-1,5.790e-2,3.000e-4/                            
      data pmac2/                                                               
     1 1.013e+3,9.020e+2,8.020e+2,7.100e+2,6.280e+2,5.540e+2,4.870e+2,          
     2 4.260e+2,3.720e+2,3.240e+2,2.810e+2,2.430e+2,2.090e+2,1.790e+2,          
     3 1.530e+2,1.300e+2,1.110e+2,9.500e+1,8.120e+1,6.950e+1,5.950e+1,          
     4 5.100e+1,4.370e+1,3.760e+1,3.220e+1,2.770e+1,1.320e+1,6.520e+0,          
     5 3.330e+0,1.760e+0,9.510e-1,6.710e-2,3.000e-4/                            
      data pmac3/                                                               
     1 1.018e+3,8.973e+2,7.897e+2,6.938e+2,6.081e+2,5.313e+2,4.627e+2,          
     2 4.016e+2,3.473e+2,2.992e+2,2.568e+2,2.199e+2,1.882e+2,1.610e+2,          
     3 1.378e+2,1.178e+2,1.007e+2,8.610e+1,7.350e+1,6.280e+1,5.370e+1,          
     4 4.580e+1,3.910e+1,3.340e+1,2.860e+1,2.430e+1,1.110e+1,5.180e+0,          
     5 2.530e+0,1.290e+0,6.820e-1,4.670e-2,3.000e-4/                            
      data pmac4/                                                               
     1 1.010e+3,8.960e+2,7.929e+2,7.000e+2,6.160e+2,5.410e+2,4.730e+2,          
     2 4.130e+2,3.590e+2,3.107e+2,2.677e+2,2.300e+2,1.977e+2,1.700e+2,          
     3 1.460e+2,1.250e+2,1.080e+2,9.280e+1,7.980e+1,6.860e+1,5.890e+1,          
     4 5.070e+1,4.360e+1,3.750e+1,3.227e+1,2.780e+1,1.340e+1,6.610e+0,          
     5 3.400e+0,1.810e+0,9.870e-1,7.070e-2,3.000e-4/                            
      data pmac5/                                                               
     1 1.013e+3,8.878e+2,7.775e+2,6.798e+2,5.932e+2,5.158e+2,4.467e+2,          
     2 3.853e+2,3.308e+2,2.829e+2,2.418e+2,2.067e+2,1.766e+2,1.510e+2,          
     3 1.291e+2,1.103e+2,9.431e+1,8.058e+1,6.882e+1,5.875e+1,5.014e+1,          
     4 4.277e+1,3.647e+1,3.109e+1,2.649e+1,2.256e+1,1.020e+1,4.701e+0,          
     5 2.243e+0,1.113e+0,5.719e-1,4.016e-2,3.000e-4/                            
      data pmac6/                                                               
     1 1.013e+3,9.020e+2,8.020e+2,7.100e+2,6.280e+2,5.540e+2,4.870e+2,          
     2 4.260e+2,3.720e+2,3.240e+2,2.810e+2,2.430e+2,2.090e+2,1.790e+2,          
     3 1.530e+2,1.300e+2,1.110e+2,9.500e+1,8.120e+1,6.950e+1,5.950e+1,          
     4 5.100e+1,4.370e+1,3.760e+1,3.220e+1,2.770e+1,1.320e+1,6.520e+0,          
     5 3.330e+0,1.760e+0,9.510e-1,6.710e-2,3.000e-4/                            
      data pmac7/                                                               
     1 1.013e+3,9.020e+2,8.020e+2,7.100e+2,6.280e+2,5.540e+2,4.870e+2,          
     2 4.260e+2,3.720e+2,3.240e+2,2.810e+2,2.430e+2,2.090e+2,1.790e+2,          
     3 1.530e+2,1.300e+2,1.110e+2,9.500e+1,8.120e+1,6.950e+1,5.950e+1,          
     4 5.100e+1,4.370e+1,3.760e+1,3.220e+1,2.770e+1,1.320e+1,6.520e+0,          
     5 3.330e+0,1.760e+0,9.510e-1,6.710e-2,3.000e-4/                            
c     the user s pressures are in mb for this pgm.                              
         do 10 i=1,33                                                           
         ii=i                                                                   
         if (p.gt.pmac(i,l)) go to 20                                           
10       continue                                                               
20       continue                                                               
      if (ii.eq.1) ii=2                                                         
         w1=(pmac(ii-1,l)-p)/(pmac(ii-1,l)-pmac(ii,l))                          
         w2=(p-pmac(ii,l))/(pmac(ii-1,l)-pmac(ii,l))                            
         qo3=o3mac(ii,l)*w1+o3mac(ii-1,l)*w2                                    
c ro3=qo3(in gm/m**3)/density of air(in gm/m**3);hence the 10**9                
         r=qo3*8.31432e7*t/(1.0e9*p*28.9644)                                    
      return                                                                    
      end                                                                       
