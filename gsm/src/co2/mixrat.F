      subroutine mixrat(m,p,t,q)                                                
      dimension a(6,7),b(6,7),qs(7),prat(6,7),ps(7)                             
      dimension pmin(7),qconst(7)                                               
c  to make pgm. flow,we assume the us std atm.=subtropical summer in            
c    water and ozone                                                            
      data qs/19.,14.,3.5,9.1,1.2,2*14./                                        
      data a/3.55,1.37,3.99,2.79,8.66,4.66,                                     
     1       3.31,4.77,4.19,1.30,8.21,4.52,                                     
     2       2.72,2.11,3.41,5.44,3.91,0.00,                                     
     3       3.76,2.95,0.83,4.71,7.43,4.28,                                     
     4       0.00,-.59,4.99,4.18,3.30,0.00,                                     
     5       3.31,4.77,4.19,1.30,8.21,4.52,                                     
     5       3.31,4.77,4.19,1.30,8.21,4.52/                                     
      data b/1.91,-7.58,-0.41,-1.52, 1.81, 0.00,                                
     1      -1.83, 0.67, 0.00,-2.26, 1.67, 0.00,                                
     2       0.39,-2.02,-0.81, 0.71, 0.00, 0.00,                                
     3       2.37,-1.01,-3.17, 0.00, 1.41, 0.00,                                
     4       0.00,-4.46, 0.86, 0.38, 0.00, 0.00,                                
     5      -1.83, 0.67, 0.00,-2.26, 1.67, 0.00,                                
     5      -1.83, 0.67, 0.00,-2.26, 1.67, 0.00/                                
      data prat/0.795 ,0.694, 0.339, 0.172, 0.110, 0.000,                       
     1          0.558, 0.421, 0.278, 0.172, 0.110, 0.000,                       
     2          0.776, 0.342, 0.263, 0.100, 0.000, 0.000,                       
     3          0.787, 0.375, 0.294, 0.145, 0.107, 0.000,                       
     4          0.876, 0.350, 0.185, 0.100, 0.000, 0.000,                       
     5          0.558, 0.421, 0.278, 0.172, 0.110, 0.000,                       
     5          0.558, 0.421, 0.278, 0.172, 0.110, 0.000/                       
      data ps/1013.01, 1013.01,1018.01,1010.01,1013.01,2*1013.01/               
      data pmin/110.99,152.99,117.79,124.99,110.29,2*152.99/                    
      data qconst/3.25,4.0,4.0,4.0,4.0,2*4.0/                                   
      const=10.0*8314.320/28.9644                                               
      pr=p/ps(m)                                                                
      n=1                                                                       
   15 if (pr.ge.prat(n,m)) go to 20                                             
      if (p.le.pmin(m)) go to 25                                                
      n=n+1                                                                     
      go to 15                                                                  
   20 eta=a(n,m)+b(n,m)*alog(pr)                                                
      q=const*(t/p)*qs(m)*pr**eta                                               
      go to 40                                                                  
   25 q=qconst(m)                                                               
      go to 40                                                                  
   40 return                                                                    
      end                                                                       
