      function antemp(l,z)                                                      
      dimension zb(10,7),c(11,7),delta(10,7),tstar(7)                           
c ************** tropical sounding **************************                   
      data (zb(n,1),n=1,10)/                                                    
     1                        2.0,   3.0,   16.5,  21.5,  45.0,                 
     2                        51.0,  70.0,  100.,  200.,  300./                 
      data (c(n,1),n=1,11)/                                                     
     1                       -6.0,  -4.0,  -6.7,   4.0,   2.2,                  
     2                        1.0,  -2.8,  -.27,   0.0,   0.0,  0.0/            
      data (delta(n,1),n=1,10)/                                                 
     1                         .5,    .5,    .3,    .5,    1.0,                 
     2                        1.0,   1.0,   1.0,   1.0,    1.0/                 
c ************** sub-tropical summer ************************                   
      data (zb(n,2),n=1,10)/                                                    
     1                        1.5,   6.5,  13.0,  18.0,  26.0,                  
     2                        36.0,  48.0,  50.0, 70.0,  100./                  
      data (c(n,2),n=1,11)/                                                     
     1                       -4.0,  -6.0,  -6.5,   0.0,   1.2,                  
     2                        2.2,   2.5,   0.0,  -3.0,  -0.25,  0.0/           
      data (delta(n,2),n=1,10)/                                                 
     1                         .5,  1.0,    .5,    .5,   1.0,                   
     2                        1.0,  2.5,    .5,   1.0,   1.0/                   
c ************** sub-tropical winter ************************                   
      data (zb(n,3),n=1,10)/                                                    
     1                        3.0,  10.0,  19.0,  25.0,  32.0,                  
     2                        44.5, 50.0,  71.0,  98.0,  200.0/                 
      data (c(n,3),n=1,11)/                                                     
     1                       -3.5,  -6.0,  -0.5,  0.0,   0.4,                   
     2                        3.2,   1.6,  -1.8, -0.7,   0.0,   0.0/            
      data (delta(n,3),n=1,10)/                                                 
     1                         .5,   .5,  1.0,   1.0,   1.0,                    
     2                        1.0,  1.0,  1.0,   1.0,   1.0/                    
c *************  sub-arctic summer *************************                    
      data (zb(n,4),n=1,10)/                                                    
     1                         4.7, 10.0,  23.0,  31.8,  44.0,                  
     2                        50.2, 69.2, 100.0, 102.0, 103.0/                  
      data (c(n,4),n=1,11)/                                                     
     1                        -5.3, -7.0,   0.0,  1.4,   3.0,                   
     2                         0.7, -3.3,  -0.2,  0.0,   0.0,  0.0/             
      data (delta(n,4),n=1,10)/                                                 
     1                         .5,   .3,  1.0,   1.0,   2.0,                    
     2                        1.0,  1.5,  1.0,   1.0,   1.0/                    
c ************ sub-arctic winter *****************************                  
      data (zb(n,5),n=1,10)/                                                    
     1                        1.0,   3.2,   8.5,   15.5,   25.0,                
     2                        30.0,  35.0,  50.0,  70.0,  100.0/                
      data (c(n,5),n=1,11)/                                                     
     1                        3.0,  -3.2,  -6.8,  0.0,  -0.6,                   
     2                        1.0,   1.2,   2.5, -0.7,  -1.2,  0.0/             
      data (delta(n,5),n=1,10)/                                                 
     1                         .4,   1.5,    .3 ,   .5,   1.0,                  
     2                        1.0,   1.0,   1.0,   1.0,   1.0/                  
c ************ us standard 1976 ******************************                  
      data (zb(n,6),n=1,10)/                                                    
     1                       11.0,  20.0,  32.0,  47.0,  51.0,                  
     2                       71.0,  84.8520,  90.0,  91.0,  92.0/               
      data (c(n,6),n=1,11)/                                                     
     1                       -6.5,   0.0,   1.0,   2.80,  0.0,                  
     2                       -2.80, -2.00,  0.0,   0.0,   0.0,  0.0/            
      data (delta(n,6),n=1,10)/                                                 
     1                        0.3,   1.0,   1.0,   1.0,   1.0,                  
     2                        1.0,   1.0,   1.0,   1.0,   1.0/                  
c                                                                               
c ************ enlarged us standard 1976 **********************                 
      data (zb(n,7),n=1,10)/                                                    
     1                       11.0,  20.0,  32.0,  47.0,  51.0,                  
     2                       71.0,  84.8520,  90.0,  91.0,  92.0/               
      data (c(n,7),n=1,11)/                                                     
     1                       -6.5,   0.0,   1.0,   2.80,  0.0,                  
     2                       -2.80, -2.00,  0.0,   0.0,   0.0,  0.0/            
      data (delta(n,7),n=1,10)/                                                 
     1                        0.3,   1.0,   1.0,   1.0,   1.0,                  
     2                        1.0,   1.0,   1.0,   1.0,   1.0/                  
c                                                                               
      data tstar/                                                               
     1            300.0,  294.0,  272.2,  287.0,  257.1, 2*288.15/              
c                                                                               
      nlast=10                                                                  
      temp=tstar(l)+c(1,l)*z                                                    
      do 20 n=1,nlast                                                           
      expo=(z-zb(n,l))/delta(n,l)                                               
      expp=zb(n,l)/delta(n,l)                                                   
      fac=exp(expp)+exp(-expp)                                                  
      if(abs(expo)-100.0) 23,23,24                                              
   23 continue                                                                  
      x=exp(expo)                                                               
      y=x+1.0/x                                                                 
      zlog=log(y)                                                               
c     zlog=alog(y)                                                              
      go to 25                                                                  
   24 zlog=abs(expo)                                                            
   25 if(expp-100.0) 27,27,28                                                   
   27 continue                                                                  
      faclog=log(fac)                                                           
      go to 29                                                                  
   28 faclog=expp                                                               
   29 continue                                                                  
c     temp=temp+(c(n+1,l)-c(n,l))*0.5*(z+delta(n,l)*                            
c    1     alog((exp(expo)+exp(-expo))/fac))                                    
      temp=temp+(c(n+1,l)-c(n,l))*0.5*(z+delta(n,l)*                            
     1     (zlog-faclog))                                                       
   20 continue                                                                  
      antemp=temp                                                               
      return                                                                    
      end                                                                       
